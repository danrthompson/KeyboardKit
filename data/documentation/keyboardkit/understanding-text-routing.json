{"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Text-Routing"},"metadata":{"role":"article","title":"Understanding Text Routing","modules":[{"name":"KeyboardKit"}],"roleHeading":"Article"},"primaryContentSections":[{"kind":"content","content":[{"type":"heading","text":"Overview","anchor":"overview","level":2},{"type":"paragraph","inlineContent":[{"text":"iOS keyboard extensions use the native ","type":"text"},{"type":"strong","inlineContent":[{"text":"UITextDocumentProxy","type":"text"}]},{"type":"text","text":" to integrate with the currently active application. However, if you have a text field "},{"inlineContent":[{"text":"in","type":"text"}],"type":"emphasis"},{"text":" your keyboard, you need to find a way to route the text to that text field instead of the active application.","type":"text"}]},{"inlineContent":[{"type":"text","text":"KeyboardKit adds ways to make text routing easier. "},{"isActive":true,"type":"reference","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController"},{"text":" has a custom ","type":"text"},{"type":"reference","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/textInputProxy","isActive":true},{"type":"text","text":" that can be set to route text from the original text document proxy to any other text field."}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"reference","isActive":true,"identifier":"https:\/\/github.com\/KeyboardKit\/KeyboardKitPro"},{"text":" unlocks even more capabilities, such as a text field and a text view that automatically register and resign as the main text document proxy. Information about Pro features can be found at the end of this article.","type":"text"}]},{"level":2,"anchor":"How-does-text-routing-work","text":"How does text routing work?","type":"heading"},{"inlineContent":[{"type":"codeVoice","code":"UIInputController"},{"text":" has a ","type":"text"},{"code":"textDocumentProxy","type":"codeVoice"},{"text":", which is how a keyboard is meant to integrate with the currently active app.","type":"text"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"text","text":"However, there may come a time when you have to type into a text field "},{"type":"emphasis","inlineContent":[{"text":"inside","type":"text"}]},{"type":"text","text":" the keyboard instead of sending the text to the main app, for instance to implement in-keyboard search."}]},{"type":"paragraph","inlineContent":[{"text":"For this to work, you need a way to route the text so it stays within your keyboard, instead of being sent to the main app. KeyboardKit makes this kind of text routing easy to implement.","type":"text"}]},{"type":"heading","level":2,"text":"How to route text with KeyboardKit","anchor":"How-to-route-text-with-KeyboardKit"},{"type":"paragraph","inlineContent":[{"type":"text","text":"KeyboardKit has a "},{"isActive":true,"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/TextInputProxy","type":"reference"},{"type":"text","text":" that can be used to route text to a custom text input. "},{"type":"reference","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController","isActive":true},{"text":" then has a ","type":"text"},{"type":"reference","isActive":true,"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/textInputProxy"},{"text":" that can be set to replace ","type":"text"},{"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/textDocumentProxy","isActive":true,"type":"reference"},{"text":" as the main text document proxy.","type":"text"}]},{"type":"paragraph","inlineContent":[{"text":"Setting ","type":"text"},{"isActive":true,"type":"reference","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/textInputProxy"},{"text":" to a custom proxy will cause any text you type into the keyboard to be sent to that proxy instead of the original proxy. Just set the custom proxy to ","type":"text"},{"type":"codeVoice","code":"nil"},{"type":"text","text":" to restore the original proxy and start routing text back to the main application."}]},{"type":"paragraph","inlineContent":[{"text":"You can always access the original text document proxy with ","type":"text"},{"isActive":true,"type":"reference","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/originalTextDocumentProxy"},{"type":"text","text":"."}]},{"type":"heading","text":"ðŸ‘‘ Pro features","level":2,"anchor":"ðŸ‘‘-Pro-features"},{"type":"paragraph","inlineContent":[{"text":"KeyboardKit Pro unlocks text input components that automatically register and unregister themselves as the main text input proxy when they receive and lose focus:","type":"text"}]},{"items":[{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"KeyboardTextField"}]},{"type":"text","text":" wraps a "},{"inlineContent":[{"type":"text","text":"UITextField"}],"type":"strong"},{"type":"text","text":" and can be used for single-line text inputs."}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"KeyboardTextView","type":"text"}]},{"type":"text","text":" wraps a "},{"type":"strong","inlineContent":[{"type":"text","text":"UITextView"}]},{"text":" and can be used for multi-line text inputs.","type":"text"}],"type":"paragraph"}]}],"type":"unorderedList"},{"type":"paragraph","inlineContent":[{"text":"Both views also support SwiftUI ","type":"text"},{"inlineContent":[{"text":"FocusState","type":"text"}],"type":"strong"},{"text":" and have a ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"focused"}]},{"type":"text","text":" view modifier that lets you provide a custom done button that slides in when the view is focused."}]},{"type":"paragraph","inlineContent":[{"text":"You can also let any ","type":"text"},{"inlineContent":[{"type":"text","text":"UIResponder & UITextInput"}],"type":"strong"},{"text":" implement the ","type":"text"},{"inlineContent":[{"type":"text","text":"KeyboardInputComponent"}],"type":"strong"},{"type":"text","text":" protocol, then call its functions to make it register and unregister as the main text document proxy."}]},{"inlineContent":[{"text":"You can also let any SwiftUI view implement the ","type":"text"},{"inlineContent":[{"type":"text","text":"KeyboardInputView"}],"type":"strong"},{"type":"text","text":" protocol to apply a focused state, together with a done button that appears when the text field has focus."}],"type":"paragraph"}]}],"hierarchy":{"paths":[["doc:\/\/KeyboardKit\/documentation\/KeyboardKit"]]},"sections":[],"seeAlsoSections":[{"identifiers":["doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Actions","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-AI-Support","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Autocomplete","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Buttons","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Callouts","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Colors","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Device-Utilities","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Dictation","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Emojis","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Extensions","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-External-Keyboards","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Feedback","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Gestures","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Images","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Layout","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Localization","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Navigation","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Previews","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Proxy-Utilities","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Settings","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-State","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Styling"],"title":"Articles","generated":true}],"kind":"article","variants":[{"paths":["\/documentation\/keyboardkit\/understanding-text-routing"],"traits":[{"interfaceLanguage":"swift"}]}],"schemaVersion":{"major":0,"minor":3,"patch":0},"abstract":[{"type":"text","text":"This article describes the KeyboardKit text routing engine."}],"references":{"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Autocomplete":{"url":"\/documentation\/keyboardkit\/understanding-autocomplete","title":"Understanding Autocomplete","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit autocomplete engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Autocomplete"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-External-Keyboards":{"url":"\/documentation\/keyboardkit\/understanding-external-keyboards","title":"Understanding External Keyboards","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit external keyboard engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-External-Keyboards"},"doc://KeyboardKit/documentation/KeyboardKit/KeyboardInputViewController/textDocumentProxy":{"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/textDocumentProxy","role":"symbol","fragments":[{"text":"var","kind":"keyword"},{"text":" ","kind":"text"},{"kind":"identifier","text":"textDocumentProxy"},{"text":": ","kind":"text"},{"text":"UITextDocumentProxy","preciseIdentifier":"c:objc(pl)UITextDocumentProxy","kind":"typeIdentifier"}],"kind":"symbol","type":"topic","url":"\/documentation\/keyboardkit\/keyboardinputviewcontroller\/textdocumentproxy","title":"textDocumentProxy","abstract":[{"type":"text","text":"The text document proxy that is currently active."}]},"doc://KeyboardKit/documentation/KeyboardKit":{"url":"\/documentation\/keyboardkit","abstract":[{"type":"text","text":"KeyboardKit helps you create custom keyboards for iOS and iPadOS, using Swift and SwiftUI."}],"type":"topic","kind":"symbol","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit","title":"KeyboardKit","role":"collection"},"https://github.com/KeyboardKit/KeyboardKitPro":{"identifier":"https:\/\/github.com\/KeyboardKit\/KeyboardKitPro","url":"https:\/\/github.com\/KeyboardKit\/KeyboardKitPro","title":"KeyboardKit Pro","type":"link","titleInlineContent":[{"text":"KeyboardKit Pro","type":"text"}]},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Previews":{"url":"\/documentation\/keyboardkit\/understanding-previews","title":"Understanding Previews","role":"article","kind":"article","type":"topic","abstract":[{"type":"text","text":"This article describes the KeyboardKit preview engine."}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Previews"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Gestures":{"url":"\/documentation\/keyboardkit\/understanding-gestures","title":"Understanding Gestures","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit gesture engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Gestures"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Extensions":{"url":"\/documentation\/keyboardkit\/understanding-extensions","title":"Understanding Extensions","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes KeyboardKit native type extensions.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Extensions"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Device-Utilities":{"url":"\/documentation\/keyboardkit\/understanding-device-utilities","title":"Understanding Device Utilities","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit device utilities.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Device-Utilities"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Callouts":{"url":"\/documentation\/keyboardkit\/understanding-callouts","title":"Understanding Callouts","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit callout engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Callouts"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Buttons":{"url":"\/documentation\/keyboardkit\/understanding-buttons","title":"Understanding Buttons","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes some general KeyboardKit buttons.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Buttons"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Actions":{"url":"\/documentation\/keyboardkit\/understanding-actions","title":"Understanding Actions","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit action engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Actions"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Feedback":{"url":"\/documentation\/keyboardkit\/understanding-feedback","title":"Understanding Feedback","role":"article","kind":"article","type":"topic","abstract":[{"type":"text","text":"This article describes the KeyboardKit feedback engine."}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Feedback"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Proxy-Utilities":{"url":"\/documentation\/keyboardkit\/understanding-proxy-utilities","title":"Understanding Proxy Utilities","role":"article","kind":"article","type":"topic","abstract":[{"type":"text","text":"This article describes the KeyboardKit proxy engine."}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Proxy-Utilities"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Layout":{"url":"\/documentation\/keyboardkit\/understanding-layout","title":"Understanding Layout","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit layout engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Layout"},"doc://KeyboardKit/documentation/KeyboardKit/TextInputProxy":{"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/TextInputProxy","role":"symbol","fragments":[{"text":"class","kind":"keyword"},{"text":" ","kind":"text"},{"kind":"identifier","text":"TextInputProxy"}],"navigatorTitle":[{"text":"TextInputProxy","kind":"identifier"}],"kind":"symbol","type":"topic","url":"\/documentation\/keyboardkit\/textinputproxy","title":"TextInputProxy","abstract":[{"type":"text","text":"This class can be used to route text from an app to another"},{"text":" ","type":"text"},{"type":"text","text":"text field, for instance in keyboard extension itself."}]},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Settings":{"url":"\/documentation\/keyboardkit\/understanding-settings","title":"Understanding Settings","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit settings engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Settings"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-AI-Support":{"url":"\/documentation\/keyboardkit\/understanding-ai-support","title":"Understanding AI Support","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit AI support.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-AI-Support"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Localization":{"url":"\/documentation\/keyboardkit\/understanding-localization","title":"Understanding Localization","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit localization engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Localization"},"doc://KeyboardKit/documentation/KeyboardKit/KeyboardInputViewController/originalTextDocumentProxy":{"kind":"symbol","title":"originalTextDocumentProxy","fragments":[{"text":"var","kind":"keyword"},{"kind":"text","text":" "},{"text":"originalTextDocumentProxy","kind":"identifier"},{"text":": ","kind":"text"},{"preciseIdentifier":"c:objc(pl)UITextDocumentProxy","kind":"typeIdentifier","text":"UITextDocumentProxy"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/originalTextDocumentProxy","url":"\/documentation\/keyboardkit\/keyboardinputviewcontroller\/originaltextdocumentproxy","role":"symbol","type":"topic","abstract":[{"type":"text","text":"The original text document proxy."}]},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-State":{"url":"\/documentation\/keyboardkit\/understanding-state","title":"Understanding State","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit state engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-State"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Colors":{"url":"\/documentation\/keyboardkit\/understanding-colors","title":"Understanding Colors","role":"article","kind":"article","type":"topic","abstract":[{"type":"text","text":"This article describes the KeyboardKit color engine."}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Colors"},"doc://KeyboardKit/documentation/KeyboardKit/KeyboardInputViewController/textInputProxy":{"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/textInputProxy","title":"textInputProxy","kind":"symbol","url":"\/documentation\/keyboardkit\/keyboardinputviewcontroller\/textinputproxy","role":"symbol","abstract":[{"text":"A custom text proxy to which text can be routed.","type":"text"}],"fragments":[{"kind":"keyword","text":"var"},{"text":" ","kind":"text"},{"text":"textInputProxy","kind":"identifier"},{"text":": ","kind":"text"},{"text":"TextInputProxy","preciseIdentifier":"c:@M@KeyboardKit@objc(cs)TextInputProxy","kind":"typeIdentifier"},{"kind":"text","text":"?"}],"type":"topic"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Dictation":{"url":"\/documentation\/keyboardkit\/understanding-dictation","title":"Understanding Dictation [BETA]","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit dictation engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Dictation"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Styling":{"url":"\/documentation\/keyboardkit\/understanding-styling","title":"Understanding Styling","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit styling engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Styling"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Emojis":{"url":"\/documentation\/keyboardkit\/understanding-emojis","title":"Understanding Emojis","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit emoji engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Emojis"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Navigation":{"url":"\/documentation\/keyboardkit\/understanding-navigation","title":"Understanding Navigation","role":"article","kind":"article","type":"topic","abstract":[{"type":"text","text":"This article describes the KeyboardKit navigation engine."}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Navigation"},"doc://KeyboardKit/documentation/KeyboardKit/KeyboardInputViewController":{"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController","role":"symbol","fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"KeyboardInputViewController"}],"navigatorTitle":[{"text":"KeyboardInputViewController","kind":"identifier"}],"kind":"symbol","type":"topic","url":"\/documentation\/keyboardkit\/keyboardinputviewcontroller","title":"KeyboardInputViewController","abstract":[{"type":"text","text":"This class extends "},{"type":"codeVoice","code":"UIInputViewController"},{"type":"text","text":" with KeyboardKit"},{"type":"text","text":" "},{"text":"specific functionality.","type":"text"}]},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Images":{"url":"\/documentation\/keyboardkit\/understanding-images","title":"Understanding Images","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit keyboard image engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Images"}}}