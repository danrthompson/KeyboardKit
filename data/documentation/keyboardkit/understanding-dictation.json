{"seeAlsoSections":[{"identifiers":["doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Actions","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-AI-Support","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Autocomplete","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Buttons","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Callouts","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Colors","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Device-Utilities","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Emojis","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Extensions","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-External-Keyboards","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Feedback","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Gestures","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Images","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Layout","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Localization","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Navigation","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Previews","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Proxy-Utilities","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Settings","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-State","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Styling","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Text-Routing"],"title":"Articles","generated":true}],"abstract":[{"type":"text","text":"This article describes the KeyboardKit dictation engine."}],"primaryContentSections":[{"kind":"content","content":[{"type":"heading","text":"Overview","anchor":"overview","level":2},{"inlineContent":[{"type":"text","text":"Dictation can be used to let users enter text by speaking instead of typing. This can however be hard to implement, since keyboard extensions canâ€™t access the microphone."}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"text","text":"KeyboardKit therefore defines dictation-specific types that you can use to implement dictation for either your keyboard extension or main app."}]},{"inlineContent":[{"type":"reference","isActive":true,"identifier":"https:\/\/github.com\/KeyboardKit\/KeyboardKitPro"},{"type":"text","text":" unlocks dictation services that can be easily configured to perform dictionary in your app as well as in your keyboard extension. Information about Pro features can be found at the end of this article."}],"type":"paragraph"},{"text":"Dictation namespace","anchor":"Dictation-namespace","type":"heading","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"KeyboardKit has a "},{"isActive":true,"type":"reference","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Dictation"},{"type":"text","text":" namespace that contains dictation-related types."}]},{"type":"paragraph","inlineContent":[{"text":"For instance, the ","type":"text"},{"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/DictationService","isActive":true,"type":"reference"},{"text":" protocol describes how to perform dictation where microphone access is available, while the ","type":"text"},{"type":"reference","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardDictationService","isActive":true},{"type":"text","text":" protocol describes how to perform it in a keyboard, where microphone access is "},{"inlineContent":[{"text":"not","type":"text"}],"type":"emphasis"},{"type":"text","text":" available."}]},{"type":"paragraph","inlineContent":[{"text":"KeyboardKit doesnâ€™t have a standard dictation service as it has for other services. Instead, it adds a disabled service to ","type":"text"},{"type":"reference","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/services","isActive":true},{"text":" until you register a custom instance or register a KeyboardKit Pro license key.","type":"text"}]},{"type":"paragraph","inlineContent":[{"text":"The namespace doesnâ€™t contain protocols, open classes, or types that are meant to be exposed at the top-level of the library.","type":"text"}]},{"anchor":"Dictation-context","text":"Dictation context","level":2,"type":"heading"},{"inlineContent":[{"type":"text","text":"KeyboardKit has an observable "},{"type":"reference","isActive":true,"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/DictationContext"},{"type":"text","text":" class that can be used to handle dictation state, such as the currently dictated text, in which application dictation was started, etc."}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"text":"KeyboardKit automatically creates an instance of this class and registers it with ","type":"text"},{"type":"reference","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/state","isActive":true},{"type":"text","text":", then updates it during dictation."}]},{"anchor":"How-to-perform-dictation","level":2,"type":"heading","text":"How to perform dictation"},{"type":"paragraph","inlineContent":[{"text":"Dictation works differently in applications, where microphone access is available, and in keyboard extensions, where itâ€™s not available.","type":"text"}]},{"type":"heading","level":3,"text":"How to perform dictation in an app","anchor":"How-to-perform-dictation-in-an-app"},{"inlineContent":[{"type":"text","text":"You can use a "},{"isActive":true,"type":"reference","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/DictationService"},{"type":"text","text":" to perform dictation where microphone access is available."}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"text","text":"To start dictation within an application, just call "},{"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/DictationService\/startDictation(with:)","isActive":true,"type":"reference"},{"text":" and observe the ","type":"text"},{"type":"reference","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardContext","isActive":true},{"text":" to see if dictation is started, to get the dictated text, fetch any errors, etc.","type":"text"}]},{"inlineContent":[{"text":"A ","type":"text"},{"isActive":true,"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/DictationService","type":"reference"},{"type":"text","text":" can call "},{"type":"reference","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/DictationService\/requestDictationAuthorization()","isActive":true},{"text":" to ask for user permissions. You can call it manually as well, before starting the operation, to avoid interrupting the first dictation with an alert.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Since dictation may stop at any time, for instance due to silence, a "},{"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/DictationService","isActive":true,"type":"reference"},{"text":" should describe how to access the result. For instance, KeyboardKit Proâ€™s ","type":"text"},{"type":"strong","inlineContent":[{"text":"ProDictationService","type":"text"}]},{"type":"text","text":" will continously update a "},{"type":"reference","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/DictationContext","isActive":true},{"text":" to let you observe the dictated text.","type":"text"}],"type":"paragraph"},{"text":"How to perform dictation in a keyboard extension","level":3,"type":"heading","anchor":"How-to-perform-dictation-in-a-keyboard-extension"},{"type":"paragraph","inlineContent":[{"text":"You can use a ","type":"text"},{"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardDictationService","isActive":true,"type":"reference"},{"text":" to perform dictation in keyboard extensions, where microphone access isnâ€™t available.","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"While in-app dictation works right away, keyboard dictation must open the app to start dictation or open an audio bridge, then write the dictated text to shared storage and return to the keyboard to let it process the result."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"This can be tricky to set up, but KeyboardKit Pro lets you configure this in a few, simple steps."}]},{"level":3,"anchor":"How-to-visualize-the-dictation-progress","text":"How to visualize the dictation progress","type":"heading"},{"inlineContent":[{"text":"KeyboardKit Pro unlocks a bunch of dictation-related views, like ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"Dictation.BarVisualizer"}]},{"type":"text","text":", "},{"inlineContent":[{"type":"text","text":"Dictation.Screen"}],"type":"strong"},{"type":"text","text":", etc. which can be used to visualize an ongoing dictation progress."}],"type":"paragraph"},{"text":"ðŸ‘‘ Pro features","type":"heading","anchor":"ðŸ‘‘-Pro-features","level":2},{"inlineContent":[{"type":"reference","overridingTitle":"KeyboardKit Pro","overridingTitleInlineContent":[{"type":"text","text":"KeyboardKit Pro"}],"isActive":true,"identifier":"https:\/\/github.com\/KeyboardKit\/KeyboardKitPro"},{"type":"text","text":" unlocks services and tools that let you setup and perform dictation with a few simple steps, with very little coding."}],"type":"paragraph"},{"anchor":"Services","text":"Services","level":3,"type":"heading"},{"inlineContent":[{"type":"text","text":"KeyboardKit Pro unlocks a "},{"inlineContent":[{"type":"text","text":"ProDictationService"}],"type":"strong"},{"text":" service that can be used within the main app, and a ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"ProKeybpardDictationService"}]},{"type":"text","text":" that can be used to trigger dictation from the keyboard extension."}],"type":"paragraph"},{"level":3,"type":"heading","text":"Supported languages","anchor":"Supported-languages"},{"type":"paragraph","inlineContent":[{"text":"By default, the speech recognizer that is used by KeyboardKit Pro supports the following languages:","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"English, Arabic, Catalan, Croatian, Czech, Danish, Dutch, Finnish, French, German, Greek, Hebrew, Hungarian, Indonesian, Italian, Malay, Norwegian, Polish, Portuguese, Romanian, Russian, Slovak, Spanish, Swedish, Turkish, Ukrainian"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"If you want to use dictation with other languages, you must implement a custom speech recognizer."}]},{"text":"Dictation views","anchor":"Dictation-views","level":3,"type":"heading"},{"type":"paragraph","inlineContent":[{"type":"text","text":"KeyboardKit Pro unlocks dictation-specific views, like "},{"type":"strong","inlineContent":[{"type":"text","text":"Dictation.Screen"}]},{"type":"text","text":" and "},{"inlineContent":[{"type":"text","text":"Dictation.BarVisualizer"}],"type":"strong"},{"text":", that you can use to build a nice dictation experience in your app or keyboard.","type":"text"}]},{"level":2,"text":"How to perform dictation with KeyboardKit Pro","type":"heading","anchor":"How-to-perform-dictation-with-KeyboardKit-Pro"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Dictation requires some configuration, but KeyboardKit Pro makes it easy to do. The following information describes how to setup a keyboard dictation that starts dictation from a keyboard and performs it in the app."}]},{"text":"Step 1. Set up required permissions","anchor":"Step-1-Set-up-required-permissions","type":"heading","level":4},{"type":"paragraph","inlineContent":[{"type":"text","text":"Before you can use dictation, you must add these keys to your appâ€™s "},{"type":"codeVoice","code":"Info.plist"},{"text":":","type":"text"}]},{"type":"codeListing","syntax":null,"code":["<key>NSMicrophoneUsageDescription<\/key>","<string>Describe why you need microphone access.<\/string>","<key>NSSpeechRecognitionUsageDescription<\/key>","<string>Describe why you need speech recognition.<\/string>"]},{"type":"paragraph","inlineContent":[{"text":"If you donâ€™t add these keys, your app will crash when you try to start dictation.","type":"text"}]},{"level":4,"text":"Step 2. Create an App Group","type":"heading","anchor":"Step-2-Create-an-App-Group"},{"type":"paragraph","inlineContent":[{"text":"To share data between an app and its keyboard, you must create an app group and enable it for both the app and the keyboard:","type":"text"}]},{"inlineContent":[{"identifier":"dictation-appgroup-app.jpg","type":"image"}],"type":"paragraph"},{"inlineContent":[{"type":"image","identifier":"dictation-appgroup-keyboard.jpg"}],"type":"paragraph"},{"type":"heading","level":4,"text":"Step 3. Create a deep link","anchor":"Step-3-Create-a-deep-link"},{"type":"paragraph","inlineContent":[{"type":"text","text":"To make it possible for the keyboard extension to open the app, you must set up a custom deep link URL scheme:"}]},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"dictation-url-scheme.jpg"}]},{"anchor":"Step-4-Create-a-keyboard-dictation-configuration","level":4,"type":"heading","text":"Step 4. Create a keyboard dictation configuration"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Next, create an app-specific "},{"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Dictation\/KeyboardConfiguration","isActive":true,"type":"reference"},{"text":" with the App Group ID and deep link that we just set up, then add it to both the main app target and the keyboard extension:","type":"text"}]},{"type":"codeListing","syntax":"swift","code":["extension KeyboardDictationConfiguration {","","    static let app = .init(","        appGroupId: \"group.com.my-app\"    ","        appDeepLink: \"YOUR-URL-SCHEME:\/\/dictation\"","    )","}"]},{"level":4,"type":"heading","anchor":"Step-5-Add-dictation-to-the-keyboard-extension","text":"Step 5. Add dictation to the keyboard extension"},{"inlineContent":[{"type":"text","text":"To configure dictation for the keyboard extension, set up the "},{"type":"strong","inlineContent":[{"text":"dictationContext","type":"text"}]},{"type":"text","text":" with the app-specific config we just created:"}],"type":"paragraph"},{"code":["class KeyboardViewController: KeyboardInputViewController {","","    override func viewWillSetupKeyboard() {","        super.viewWillSetupKeyboard()","        let keyboardSettings = keyboardSettings","        setupPro(withLicenseKey: \"...\") { license in","            state.dictationContext.setup(with: .app)","        } view: { controller in","            \/\/ Return your keyboard view here","        }","    }","} "],"type":"codeListing","syntax":"swift"},{"level":4,"anchor":"Step-6-Add-dictation-to-the-main-application","text":"Step 6. Add dictation to the main application","type":"heading"},{"inlineContent":[{"text":"To configure keyboard dictation for the app, first register your KeyboardKit Pro license key:","type":"text"}],"type":"paragraph"},{"type":"codeListing","code":["@main","struct MyApp: App {","","    init() {","        registerProLicense()","    }","","    var body: some Scene {","        WindowGroup {","            ContentView()","        }","    }","","    func registerProLicense() {","        Task {","            try? await License.register(","                licenseKey: \"your license key\",","            )","        }","    }","}"],"syntax":"swift"},{"type":"paragraph","inlineContent":[{"text":"Then create a ","type":"text"},{"type":"reference","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/DictationContext","isActive":true},{"text":" with the same config and apply it to the appâ€™s root view with a ","type":"text"},{"inlineContent":[{"text":".keyboardDictation(â€¦)","type":"text"}],"type":"strong"},{"type":"text","text":" modifier:"}]},{"syntax":"swift","code":["struct ContentView: View {","","    @StateObject","    var context = DictationContext(config: .app)","","    var body: some View {","        NavigationStack(path: $path) {","            ...","        }","        .keyboardDictation(","            context: context,","            config: .app,","            speechRecognizer: recognizer,   \/\/ See further down","            overlay: overlay","        )","    }","","    func overlay() -> some View {","        Dictation.Screen(","            dictationContext: context,","            titleView: { EmptyView() },","            indicator: { Dictation.BarVisualizer(isAnimating: $0) }","        )","    } ","}"],"type":"codeListing"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Use the "},{"type":"codeVoice","code":"overlay"},{"type":"text","text":" parameter to specify the view that will overlay the root view while dictation is active. You can use KeyboardKit Proâ€™s "},{"inlineContent":[{"type":"text","text":"Dictation.Screen"}],"type":"strong"},{"type":"text","text":" with any of the built-in visualizers to easily visualize the dictation."}]},{"type":"heading","level":4,"anchor":"7-Create-a-speech-recognizer","text":"7. Create a speech recognizer"},{"type":"paragraph","inlineContent":[{"type":"text","text":"KeyboardKit Pro doesnâ€™t contain a "},{"code":"SpeechRecognizer","type":"codeVoice"},{"text":", since the ","type":"text"},{"code":"Speech","type":"codeVoice"},{"text":" framework would force all apps to specify permissions for dictation, even if they arenâ€™t using dictation.","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Instead, just copy the code below and pass in a "},{"code":"StandardSpeechRecognizer()","type":"codeVoice"},{"text":" in the modifier above:","type":"text"}]},{"code":["import Speech","import KeyboardKitPro","","public class StandardSpeechRecognizer: SpeechRecognizer {","","    public init() {}","","    public var supportedLocales: [KeyboardLocale] {","        [","            .english, .arabic, .catalan, .croatian, .czech,","            .danish, .dutch, .dutch_belgium, .english_gb,","            .english_us, .finnish, .french, .french_belgium,","            .french_switzerland, .german, .german_austria,","            .german_switzerland, .greek, .hebrew, .hungarian,","            .indonesian, .italian, .malay, .norwegian, .polish,","            .portuguese, .portuguese_brazil, .romanian, .russian,","            .slovak, .spanish, .swedish, .turkish, .ukrainian","        ]","    }","","    private var resultHandler: ResultHandler?","    private var speechRecognizer: SFSpeechRecognizer?","    private var speechRecognizerRequest: SFSpeechAudioBufferRecognitionRequest?","    private var speechRecognizerTask: SFSpeechRecognitionTask?","}","","public extension StandardSpeechRecognizer {","","    var authorizationStatus: Dictation.AuthorizationStatus {","        SFSpeechRecognizer.authorizationStatus().keyboardDictationStatus","    }","","    func requestDictationAuthorization() async throws -> Dictation.AuthorizationStatus {","        await withCheckedContinuation { continuation in","            SFSpeechRecognizer.requestAuthorization { status in","                continuation.resume(returning: status.keyboardDictationStatus)","            }","        }","    }","","    func resetDictationResult() async throws {}","","    func startDictation(","        with config: Dictation.Configuration","    ) async throws {","        try await startDictation(with: config, resultHandler: nil)","    }","","    func startDictation(","        with config: Dictation.Configuration,","        resultHandler: ResultHandler?","    ) async throws {","        guard let recognizer = setupSpeechRecognizer(for: config) else { throw Dictation.ServiceError.missingSpeechRecognizer }","        guard let request = setupSpeechRecognizerRequest() else { throw Dictation.ServiceError.missingSpeechRecognitionRequest }","        self.resultHandler = resultHandler","        setupSpeechRecognizerTask(for: recognizer, and: request)","    }","","    func stopDictation() async throws {","        speechRecognizerRequest?.endAudio()","        speechRecognizerRequest = nil","        speechRecognizerTask?.cancel()","        speechRecognizerTask = nil","    }","","    func setupAudioEngineBuffer(_ buffer: AVAudioPCMBuffer) {","        speechRecognizerRequest?.append(buffer)","    }","}","","private extension StandardSpeechRecognizer {","","    func setupSpeechRecognizer(for config: Dictation.Configuration) -> SFSpeechRecognizer? {","        let locale = Locale(identifier: config.localeId)","        speechRecognizer = SFSpeechRecognizer(locale: locale)","        return speechRecognizer","    }","","    func setupSpeechRecognizerRequest() -> SFSpeechAudioBufferRecognitionRequest? {","        speechRecognizerRequest = SFSpeechAudioBufferRecognitionRequest()","        speechRecognizerRequest?.shouldReportPartialResults = true","        return speechRecognizerRequest","    }","","    func setupSpeechRecognizerTask(","        for recognizer: SFSpeechRecognizer,","        and request: SFSpeechRecognitionRequest","    ) {","        speechRecognizerTask = recognizer.recognitionTask(with: request) { [weak self] in","            self?.handleTaskResult($0, error: $1)","        }","    }","","    func handleTaskResult(_ result: SFSpeechRecognitionResult?, error: Error?) {","        let result = SpeechRecognizerResult(","            dictatedText: result?.bestTranscription.formattedString,","            error: error,","            isFinal: result?.isFinal ?? true)","        resultHandler?(result)","    }","}"],"type":"codeListing","syntax":"swift"},{"level":4,"type":"heading","text":"8. Perform dictation","anchor":"8-Perform-dictation"},{"inlineContent":[{"type":"text","text":"You can now start dictation in your keyboard by triggering a "},{"isActive":true,"type":"reference","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardAction\/dictation"},{"text":" action or calling ","type":"text"},{"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardDictationService\/startDictationFromKeyboard(with:)","isActive":true,"type":"reference"},{"text":".","type":"text"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"text","text":"If everything is correctly configured, the keyboard should open your app to start dictation, then return to the keyboard when dictation finishes. The keyboard will then automatically read the dictated text and send it to the document."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Override "},{"type":"reference","isActive":true,"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/viewWillHandleDictationResult()"},{"text":" if you want to customize how your keyboard handles the dictation result.","type":"text"}]},{"name":"Important","style":"important","content":[{"inlineContent":[{"text":"In a DocumentGroup, the .keyboardDictation modifier only works if a document is open. To work around this, you can instead check if isDictationStartedByKeyboard is true. If so, present a sheet or modal and add .keyboardDictationOnAppear to its root view.","type":"text"}],"type":"paragraph"}],"type":"aside"},{"type":"heading","level":4,"anchor":"9-Return-to-the-keyboard","text":"9. Return to the keyboard"},{"inlineContent":[{"type":"text","text":"Once dictation is done, the app should return to the keyboard to let it handle the dictated text."}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"text","text":"KeyboardKit Pro used to have a "},{"type":"strong","inlineContent":[{"text":"PreviousAppNavigator","type":"text"}]},{"type":"text","text":" that was used to navigate back to the previous app, but it stopped working in iOS 17. When the updated code was rejected by Apple, this functionality has been removed."}]},{"type":"paragraph","inlineContent":[{"text":"Since KeyboardKit canâ€™t add these implementations to the library, you have to implement the return operation yourself. To do so, inherit ","type":"text"},{"type":"strong","inlineContent":[{"text":"ProKeyboardDictationService","type":"text"}]},{"type":"text","text":", override "},{"type":"strong","inlineContent":[{"text":"tryToReturnToKeyboard","type":"text"}]},{"type":"text","text":" and inject your service into the "},{"type":"strong","inlineContent":[{"type":"text","text":"keyboardDictation"}]},{"text":" modifier:","type":"text"}]},{"type":"codeListing","syntax":"swift","code":["class CustomDictationService: ProKeyboardDictationService {","","    override func tryToReturnToKeyboard() {","        \/\/ Add your code here","    }","}"]},{"inlineContent":[{"type":"text","text":"See "},{"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Navigation","type":"reference","isActive":true},{"type":"text","text":" for the two previous implementations that were previously used by the library. Although they will both be rejected by Apple, perhaps they can give you some inspiration."}],"type":"paragraph"}]}],"identifier":{"url":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Dictation","interfaceLanguage":"swift"},"schemaVersion":{"minor":3,"major":0,"patch":0},"metadata":{"modules":[{"name":"KeyboardKit"}],"role":"article","roleHeading":"Article","title":"Understanding Dictation [BETA]"},"kind":"article","hierarchy":{"paths":[["doc:\/\/KeyboardKit\/documentation\/KeyboardKit"]]},"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/keyboardkit\/understanding-dictation"]}],"sections":[],"references":{"dictation-appgroup-keyboard.jpg":{"alt":"Set up an App Group for the keyboard","identifier":"dictation-appgroup-keyboard.jpg","type":"image","variants":[{"traits":["1x","light"],"url":"\/images\/dictation-appgroup-keyboard.jpg"}]},"doc://KeyboardKit/documentation/KeyboardKit/KeyboardInputViewController/services":{"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/services","title":"services","kind":"symbol","url":"\/documentation\/keyboardkit\/keyboardinputviewcontroller\/services","role":"symbol","abstract":[{"type":"text","text":"The default set of keyboard-specific services."}],"fragments":[{"kind":"keyword","text":"var"},{"text":" ","kind":"text"},{"text":"services","kind":"identifier"},{"kind":"text","text":": "},{"kind":"typeIdentifier","preciseIdentifier":"s:11KeyboardKit0A0V","text":"Keyboard"},{"text":".","kind":"text"},{"text":"KeyboardServices","preciseIdentifier":"s:11KeyboardKit0A0V0A8ServicesC","kind":"typeIdentifier"}],"type":"topic"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-External-Keyboards":{"url":"\/documentation\/keyboardkit\/understanding-external-keyboards","title":"Understanding External Keyboards","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit external keyboard engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-External-Keyboards"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Layout":{"url":"\/documentation\/keyboardkit\/understanding-layout","title":"Understanding Layout","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit layout engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Layout"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Navigation":{"url":"\/documentation\/keyboardkit\/understanding-navigation","title":"Understanding Navigation","role":"article","kind":"article","type":"topic","abstract":[{"type":"text","text":"This article describes the KeyboardKit navigation engine."}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Navigation"},"doc://KeyboardKit/documentation/KeyboardKit/DictationContext":{"fragments":[{"kind":"keyword","text":"class"},{"text":" ","kind":"text"},{"text":"DictationContext","kind":"identifier"}],"type":"topic","url":"\/documentation\/keyboardkit\/dictationcontext","role":"symbol","abstract":[{"type":"text","text":"This context can be used to handle regular in-app dictation"},{"type":"text","text":" "},{"type":"text","text":"and keyboard-based dictation."}],"navigatorTitle":[{"text":"DictationContext","kind":"identifier"}],"kind":"symbol","title":"DictationContext","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/DictationContext"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Colors":{"url":"\/documentation\/keyboardkit\/understanding-colors","title":"Understanding Colors","role":"article","kind":"article","type":"topic","abstract":[{"type":"text","text":"This article describes the KeyboardKit color engine."}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Colors"},"doc://KeyboardKit/documentation/KeyboardKit/KeyboardInputViewController/viewWillHandleDictationResult()":{"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/viewWillHandleDictationResult()","role":"symbol","fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"text":"viewWillHandleDictationResult","kind":"identifier"},{"text":"()","kind":"text"}],"kind":"symbol","type":"topic","url":"\/documentation\/keyboardkit\/keyboardinputviewcontroller\/viewwillhandledictationresult()","title":"viewWillHandleDictationResult()","abstract":[{"type":"text","text":"This function is called to handle any dictation results"},{"type":"text","text":" "},{"type":"text","text":"when returning from the main app."}]},"doc://KeyboardKit/documentation/KeyboardKit/KeyboardContext":{"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardContext","abstract":[{"type":"text","text":"This class provides keyboard extensions with contextual and"},{"type":"text","text":" "},{"type":"text","text":"observable information about the keyboard extension itself."}],"url":"\/documentation\/keyboardkit\/keyboardcontext","type":"topic","role":"symbol","title":"KeyboardContext","navigatorTitle":[{"kind":"identifier","text":"KeyboardContext"}],"fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"text":"KeyboardContext","kind":"identifier"}],"kind":"symbol"},"doc://KeyboardKit/documentation/KeyboardKit/DictationService":{"role":"symbol","navigatorTitle":[{"kind":"identifier","text":"DictationService"}],"kind":"symbol","abstract":[{"text":"This protocol can be implemented by classes that can handle","type":"text"},{"type":"text","text":" "},{"text":"dictation, e.g. by using the device microphone.","type":"text"}],"fragments":[{"text":"protocol","kind":"keyword"},{"text":" ","kind":"text"},{"text":"DictationService","kind":"identifier"}],"type":"topic","title":"DictationService","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/DictationService","url":"\/documentation\/keyboardkit\/dictationservice"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Actions":{"url":"\/documentation\/keyboardkit\/understanding-actions","title":"Understanding Actions","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit action engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Actions"},"doc://KeyboardKit/documentation/KeyboardKit/KeyboardDictationService":{"navigatorTitle":[{"kind":"identifier","text":"KeyboardDictationService"}],"title":"KeyboardDictationService","abstract":[{"text":"This protocol can be implemented by classes that can handle","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"dictations between a keyboard extension and its parent app."}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardDictationService","url":"\/documentation\/keyboardkit\/keyboarddictationservice","type":"topic","kind":"symbol","role":"symbol","fragments":[{"text":"protocol","kind":"keyword"},{"kind":"text","text":" "},{"text":"KeyboardDictationService","kind":"identifier"}]},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Extensions":{"url":"\/documentation\/keyboardkit\/understanding-extensions","title":"Understanding Extensions","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes KeyboardKit native type extensions.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Extensions"},"doc://KeyboardKit/documentation/KeyboardKit/Dictation":{"title":"Dictation","role":"symbol","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Dictation","fragments":[{"kind":"keyword","text":"struct"},{"text":" ","kind":"text"},{"text":"Dictation","kind":"identifier"}],"navigatorTitle":[{"text":"Dictation","kind":"identifier"}],"type":"topic","url":"\/documentation\/keyboardkit\/dictation","abstract":[{"text":"This namespace contains dictation-related types, as well as","type":"text"},{"type":"text","text":" "},{"type":"text","text":"disabled service implementations."}],"kind":"symbol"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Feedback":{"url":"\/documentation\/keyboardkit\/understanding-feedback","title":"Understanding Feedback","role":"article","kind":"article","type":"topic","abstract":[{"type":"text","text":"This article describes the KeyboardKit feedback engine."}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Feedback"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Previews":{"url":"\/documentation\/keyboardkit\/understanding-previews","title":"Understanding Previews","role":"article","kind":"article","type":"topic","abstract":[{"type":"text","text":"This article describes the KeyboardKit preview engine."}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Previews"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Buttons":{"url":"\/documentation\/keyboardkit\/understanding-buttons","title":"Understanding Buttons","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes some general KeyboardKit buttons.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Buttons"},"dictation-appgroup-app.jpg":{"identifier":"dictation-appgroup-app.jpg","type":"image","alt":"Set up an App Group for the app","variants":[{"traits":["1x","light"],"url":"\/images\/dictation-appgroup-app.jpg"}]},"dictation-url-scheme.jpg":{"alt":"Set up a URL Scheme for the app","identifier":"dictation-url-scheme.jpg","type":"image","variants":[{"traits":["1x","light"],"url":"\/images\/dictation-url-scheme.jpg"}]},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Gestures":{"url":"\/documentation\/keyboardkit\/understanding-gestures","title":"Understanding Gestures","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit gesture engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Gestures"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Device-Utilities":{"url":"\/documentation\/keyboardkit\/understanding-device-utilities","title":"Understanding Device Utilities","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit device utilities.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Device-Utilities"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Emojis":{"url":"\/documentation\/keyboardkit\/understanding-emojis","title":"Understanding Emojis","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit emoji engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Emojis"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Localization":{"url":"\/documentation\/keyboardkit\/understanding-localization","title":"Understanding Localization","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit localization engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Localization"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Proxy-Utilities":{"url":"\/documentation\/keyboardkit\/understanding-proxy-utilities","title":"Understanding Proxy Utilities","role":"article","kind":"article","type":"topic","abstract":[{"type":"text","text":"This article describes the KeyboardKit proxy engine."}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Proxy-Utilities"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Callouts":{"url":"\/documentation\/keyboardkit\/understanding-callouts","title":"Understanding Callouts","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit callout engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Callouts"},"doc://KeyboardKit/documentation/KeyboardKit":{"url":"\/documentation\/keyboardkit","abstract":[{"type":"text","text":"KeyboardKit helps you create custom keyboards for iOS and iPadOS, using Swift and SwiftUI."}],"type":"topic","kind":"symbol","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit","title":"KeyboardKit","role":"collection"},"doc://KeyboardKit/documentation/KeyboardKit/Dictation/KeyboardConfiguration":{"navigatorTitle":[{"kind":"identifier","text":"KeyboardConfiguration"}],"url":"\/documentation\/keyboardkit\/dictation\/keyboardconfiguration","type":"topic","fragments":[{"text":"struct","kind":"keyword"},{"kind":"text","text":" "},{"text":"KeyboardConfiguration","kind":"identifier"}],"title":"Dictation.KeyboardConfiguration","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Dictation\/KeyboardConfiguration","abstract":[{"text":"This can be used with a ","type":"text"},{"type":"reference","isActive":true,"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardDictationService"},{"text":".","type":"text"}],"kind":"symbol","role":"symbol"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-State":{"url":"\/documentation\/keyboardkit\/understanding-state","title":"Understanding State","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit state engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-State"},"doc://KeyboardKit/documentation/KeyboardKit/DictationService/requestDictationAuthorization()":{"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/DictationService\/requestDictationAuthorization()","required":true,"kind":"symbol","fragments":[{"kind":"keyword","text":"func"},{"text":" ","kind":"text"},{"kind":"identifier","text":"requestDictationAuthorization"},{"text":"() ","kind":"text"},{"text":"async","kind":"keyword"},{"text":" ","kind":"text"},{"text":"throws","kind":"keyword"},{"text":" -> ","kind":"text"},{"kind":"typeIdentifier","text":"Dictation","preciseIdentifier":"s:11KeyboardKit9DictationV"},{"text":".","kind":"text"},{"kind":"typeIdentifier","text":"AuthorizationStatus","preciseIdentifier":"s:11KeyboardKit9DictationV19AuthorizationStatusO"}],"type":"topic","url":"\/documentation\/keyboardkit\/dictationservice\/requestdictationauthorization()","abstract":[{"text":"Request dictation authorization.","type":"text"}],"role":"symbol","title":"requestDictationAuthorization()"},"https://github.com/KeyboardKit/KeyboardKitPro":{"title":"KeyboardKit Pro","identifier":"https:\/\/github.com\/KeyboardKit\/KeyboardKitPro","titleInlineContent":[{"type":"text","text":"KeyboardKit Pro"}],"type":"link","url":"https:\/\/github.com\/KeyboardKit\/KeyboardKitPro"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Text-Routing":{"url":"\/documentation\/keyboardkit\/understanding-text-routing","title":"Understanding Text Routing","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit text routing engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Text-Routing"},"doc://KeyboardKit/documentation/KeyboardKit/KeyboardDictationService/startDictationFromKeyboard(with:)":{"url":"\/documentation\/keyboardkit\/keyboarddictationservice\/startdictationfromkeyboard(with:)","role":"symbol","abstract":[{"type":"text","text":"Start a dictation operation from the keyboard."}],"fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"kind":"identifier","text":"startDictationFromKeyboard"},{"text":"(","kind":"text"},{"text":"with","kind":"externalParam"},{"kind":"text","text":": "},{"kind":"typeIdentifier","preciseIdentifier":"s:11KeyboardKit9DictationV","text":"Dictation"},{"kind":"text","text":"."},{"text":"KeyboardConfiguration","preciseIdentifier":"s:11KeyboardKit9DictationV0A13ConfigurationV","kind":"typeIdentifier"},{"text":") ","kind":"text"},{"text":"async","kind":"keyword"},{"kind":"text","text":" "},{"text":"throws","kind":"keyword"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardDictationService\/startDictationFromKeyboard(with:)","required":true,"kind":"symbol","title":"startDictationFromKeyboard(with:)","type":"topic"},"doc://KeyboardKit/documentation/KeyboardKit/DictationService/startDictation(with:)":{"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/DictationService\/startDictation(with:)","required":true,"url":"\/documentation\/keyboardkit\/dictationservice\/startdictation(with:)","role":"symbol","type":"topic","abstract":[{"text":"Start dictating with the provided configuration.","type":"text"}],"kind":"symbol","fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"kind":"identifier","text":"startDictation"},{"kind":"text","text":"("},{"text":"with","kind":"externalParam"},{"kind":"text","text":": "},{"text":"Dictation","preciseIdentifier":"s:11KeyboardKit9DictationV","kind":"typeIdentifier"},{"text":".","kind":"text"},{"kind":"typeIdentifier","preciseIdentifier":"s:11KeyboardKit9DictationV13ConfigurationV","text":"Configuration"},{"text":") ","kind":"text"},{"text":"async","kind":"keyword"},{"kind":"text","text":" "},{"text":"throws","kind":"keyword"}],"title":"startDictation(with:)"},"doc://KeyboardKit/documentation/KeyboardKit/KeyboardAction/dictation":{"url":"\/documentation\/keyboardkit\/keyboardaction\/dictation","role":"symbol","abstract":[{"text":"Represents a dictation key, which are not included by the standard layouts.","type":"text"}],"fragments":[{"kind":"keyword","text":"case"},{"text":" ","kind":"text"},{"text":"dictation","kind":"identifier"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardAction\/dictation","kind":"symbol","title":"KeyboardAction.dictation","type":"topic"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Styling":{"url":"\/documentation\/keyboardkit\/understanding-styling","title":"Understanding Styling","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit styling engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Styling"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-AI-Support":{"url":"\/documentation\/keyboardkit\/understanding-ai-support","title":"Understanding AI Support","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit AI support.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-AI-Support"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Settings":{"url":"\/documentation\/keyboardkit\/understanding-settings","title":"Understanding Settings","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit settings engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Settings"},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Images":{"url":"\/documentation\/keyboardkit\/understanding-images","title":"Understanding Images","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit keyboard image engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Images"},"doc://KeyboardKit/documentation/KeyboardKit/KeyboardInputViewController/state":{"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/state","role":"symbol","fragments":[{"kind":"keyword","text":"var"},{"text":" ","kind":"text"},{"text":"state","kind":"identifier"},{"text":": ","kind":"text"},{"text":"Keyboard","kind":"typeIdentifier","preciseIdentifier":"s:11KeyboardKit0A0V"},{"kind":"text","text":"."},{"text":"KeyboardState","kind":"typeIdentifier","preciseIdentifier":"s:11KeyboardKit0A0V0A5StateC"}],"kind":"symbol","type":"topic","url":"\/documentation\/keyboardkit\/keyboardinputviewcontroller\/state","title":"state","abstract":[{"type":"text","text":"The default set of keyboard-specific state."}]},"doc://KeyboardKit/documentation/KeyboardKit/Understanding-Autocomplete":{"url":"\/documentation\/keyboardkit\/understanding-autocomplete","title":"Understanding Autocomplete","role":"article","kind":"article","type":"topic","abstract":[{"text":"This article describes the KeyboardKit autocomplete engine.","type":"text"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Understanding-Autocomplete"}}}